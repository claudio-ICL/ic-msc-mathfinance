\documentclass[10pt,a4paper]{article}
\include{preamble}
\date{Friday 4 December 2020}
\usepackage{fancyhdr}
\pagestyle{fancy}
\fancyhf{}
\rhead{Problem Set 3}
\lhead{Algorithmic Trading and Machine Learning}
\cfoot{Page \thepage}

\include{notation}
\begin{document}
	
	\begin{center}
		\begin{figure}
			\includegraphics[width=0.2\textwidth]{imperial_logo_light}
		\end{figure}
	\begin{Large}
		Algorithmic Trading and Machine Learning \\
		\textsc{Problem Set 3}
	\end{Large}
	\end{center}

\vspace{0.2cm}

\noindent Friday 4 December 2020 \\
\noindent Claudio Bellani, \small{\texttt{ c.bellani17@imperial.ac.uk}}

\vspace{0.5cm}



\begin{exercise}
\label{ex.GS11}
Consider the following trade execution setting. 
Time $t$ is continuous, and it ranges from $0$, start of the execution, to $T$, execution horizon. 
Let $\price_t$ denote the time-$t$ fundamental price of the asset being traded. 
`Fundamental price' means that $\price_t$ does not incorporate any impact;
the mid-price can be thought of as a proxy for the fundamental price of an asset. 
We assume that $\price_t$ evolves as a geometric Brownian motion, namely that
$d\price_t = \sigma \price_t d\WienerProc_t$, 
for some constant $\sigma$
and some standard one-dimensional Brownian motion $\WienerProc$. 
We let $\filtration$ be the filtration generated by $\WienerProc$. 
The execution price at time $t$ of the amount $v$ is 
$\price_t + \theta v$, 
for some coefficient of temporary impact $\theta$. 

Let $x_0$ denote the overall quantity to execute. 
Let $X_t$ denote the time-$t$ quantity left to execute by time $T$. 
We say that a stochastic process 
  $\lbrace X_t (\omega): \, 0 \leq t \leq T , \, \omega \in \Omega\rbrace$ 
is an admissible inventory trajectory if:
1. $X_0 = x_0$ and $X_T = 0$; 
2. for every $\omega$ the path $t\mapsto X_t (\omega)$ is differentiable; 
3.  
the derivative process 
  $\lbrace \dot{X}_t (\omega) = d X_t (\omega) / dt : \, 0\leq t \leq T, \, \omega \in \Omega\rbrace$
is progressively measurable with respect to $\filtration$;
4. the following squared-integrability holds: 
  $\Expectation[\int_{0}^{T} \dot{X}_{t}\squared dt ] < \infinity.$
We let $\algebra$ denote the class of admissible inventory trajectories. 
Every admissible inventory trajectory represents a trading strategy and viceversa,
so we use the two terms interchangeably. 

We formulate the problem of optimal trade execution following Gatheral and Schied (2011). 
More precisely, the overall execution cost associated with the admissible trading strategy $X$ in $\algebra$ is 
  \begin{equation*}
    \int_{0}^{T} (- \dot{X}_t)\left( \price_t - \theta \dot{X}_t\right) dt, 
  \end{equation*}
and its overall risk is
  \begin{equation*}
    \int_{0}^{T} X_t \price_t dt.
  \end{equation*}
Therefore, the expected risk-adjusted execution cost is 
  \begin{equation*}
    \Expectation 
    \left[ 
    \int_{0}^{T} (- \dot{X}_t)\left( \price_t - \theta \dot{X}_t\right) dt 
    +\tilde{\lambda} \int_{0}^{T} X_t \price_t dt
    \right],
  \end{equation*}
  for some coefficient $\tilde{\lambda}$ of risk aversion.
\begin{enumerate}[label={\textbf{\ref{ex.GS11}.\arabic{*}}}, ref={Exercise {\ref{ex.GS11}.\arabic{*}}}]
  \item 
    Show that minimising risk-adjusted execution costs over the set $\algebra$ of admissible inventory trajectories is equivalent to the following minimisation problem:
    \begin{equation}
      \label{eq.minimisationproblem}
      \inf \left\lbrace 
      \Expectation \left[ 
      \int_{0}^{T} \left( \dot{X}_{t}\squared + \lambda X_t \price_t \right) dt 
      \right] : \, X \in \algebra
      \right\rbrace,
    \end{equation}
    where $\lambda = \tilde{\lambda}/\theta$. 
  \item
    Let $C^{\star}_t (x)$ be the value function for the minimisation in  \eqref{eq.minimisationproblem}, 
    namely $C^{\star}_t (x)$ is the minimal trading cost 
    that a trader may incur into from time $t$ to time $T$ if the inventory at time $t$ is equal to $x$. 
    We cast the Bellman principle in our setting by stating that for all $X$ in $\algebra$ and all $t<\tau<T$ it holds
    \begin{equation}
      \begin{split}
        C^{\star}_t(x) = &
        \inf \Big\lbrace
        \Expectation_t \left[
        \int_{t}^{\tau} \left(\dot{X}_{u}\squared + \lambda X_u \price_u \right)du
        + 
          C^{\star}_{\tau}(X_{\tau})
        \right]:
        \quad X\in \algebra, \, X_t=x
      \Big\rbrace
      \end{split}
    \end{equation}
    Show that this implies that 
    \begin{equation*}
    C^{\star}_t(X_t) + \int_{0}^{t} (\dot{X}_{u}\squared + \lambda X_u \price_u )du
    \end{equation*}
    is a local sub-martingale for all $X$ in $\algebra$. 
  \item 
    We take for a fact that if we can find a smooth function $\Gstar=\Gstar(t, s, x)$ such that 
    $\Gstar(t,\price_t,  X_t) + \int_{0}^{t} (\dot{X}_{u}\squared + \lambda X_u \price_u )du$
    is a local sub-martingale for all $X$ in $\algebra$, 
    then 
    $C^{\star}_t(x) = \Gstar(t, \price_t, x)$ for all $0\leq t \leq T$ and all $x\in\R$. 

    Let $G=G(t, s, x)$ be a function in $C^{1, 2, 1}([0,T]\times \R \times \R)$. 
    For an arbitrary $X$ in $\algebra$, define 
    \begin{equation*}
      M_t : = G(t, \price_t, X_t) + \int_{0}^{t} (\dot{X}_{u}\squared + \lambda X_u \price_u )du.
    \end{equation*}
    Show that $M$ is a local sub-martingale
    if $G$ satisfies the following partial differential equation:
    \begin{equation}
      \label{eq.GS11pde}
      \partial_t G + \frac{\sigma\squared}{2} s\squared \partial_{ss}\squared G
      -\frac{1}{4} (\partial_x G)\squared + \lambda xs
      \geq 0 
    \end{equation}
    for all $0\leq t \leq T$ and all $s, x$ in $\R$.
  \item 
    Define the function 
    \begin{equation}
      \label{eq.Gstar}
      \begin{split}
        \Gstar(t, s, x):=&
      \frac{x\squared}{T-t}
      +\frac{\lambda s x }{2}(T-t) 
      \\
      &
      -\frac{\lambda\squared s\squared}{8 \sigma^{6}}
      \left(
      \exp(\sigma\squared(T-t))
      -1 - \sigma\squared(T-t) - \frac{\sigma^{4}}{2}(T-t)\squared
      \right)
      \end{split}
    \end{equation}
    \begin{enumerate}
      \item Show that $\Gstar$ solves equation \eqref{eq.GS11pde} with equality;
      \item Show that for all $X$ in $\algebra$ it holds 
        $\Expectation[\Gstar(t, \price_t, X_t)] \rightarrow 0 $ as $t\uparrow T$. 
    \end{enumerate}
  \item 
    Show that for all $X$ in $\algebra$ it holds 
    \begin{equation}
      \Gstar(0, x_0, s_0) \leq 
      \Expectation \left[
        \int_{0}^{T} \left( \dot{X}_{t}\squared + \lambda X_t \price_t \right) dt 
        \right],
    \end{equation}
    where $\Gstar$ is as in equation \eqref{eq.Gstar}.
  \item Conclude that 
    \begin{equation}
      X^{\star}_t = \frac{T-t}{T}x_0 - \frac{\lambda}{4}(T-t) \int_{0}^{t} \price_u du 
    \end{equation}
    is the optimal trading strategy. 
\end{enumerate}
\end{exercise}
\end{document}
